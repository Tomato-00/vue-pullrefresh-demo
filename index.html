<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>下拉刷新个性化配置 - Vue2 学习项目</title>
    
    <!-- 使用系统圆润字体，无需引入外部字体 -->
    
    <!-- 引入样式文件 -->
    <link rel="stylesheet" href="styles.css">
    
    <!-- 引入 Vue 2.x 库 -->
    <!-- 
        CDN 加载方案（多级自动切换）：
        如果第一个 CDN 失败，会自动尝试下一个，直到成功加载
    -->
    <script>
        // 多级 CDN Fallback 机制
        (function() {
            var CDN_SOURCES = [
                'https://unpkg.com/vue@2.6.14/dist/vue.js',           // unpkg（全球 CDN，通常最稳定）
                'https://cdn.bootcdn.net/ajax/libs/vue/2.6.14/vue.js', // bootcdn（国内用户首选）
                'https://cdnjs.cloudflare.com/ajax/libs/vue/2.6.14/vue.min.js', // cdnjs（Cloudflare CDN）
                'vue.js' // 本地文件（如果已下载）
            ];
            
            var currentIndex = 0;
            var script = document.createElement('script');
            script.type = 'text/javascript';
            
            script.onerror = function() {
                currentIndex++;
                if (currentIndex < CDN_SOURCES.length) {
                    console.warn('CDN 加载失败，尝试下一个:', CDN_SOURCES[currentIndex]);
                    script.src = CDN_SOURCES[currentIndex];
                    document.head.appendChild(script);
                } else {
                    console.error('所有 CDN 都加载失败！');
                    alert('Vue.js 加载失败！\n\n请尝试以下解决方案：\n1. 检查网络连接\n2. 使用本地文件（下载 vue.js 到项目目录）');
                }
            };
            
            script.onload = function() {
                console.log('Vue.js 加载成功！来源:', script.src);
                // Vue.js 加载完成后，再加载 app.js
                loadAppScript();
            };
            
            script.src = CDN_SOURCES[0];
            document.head.appendChild(script);
            
            // 加载 app.js 的函数
            function loadAppScript() {
                var appScript = document.createElement('script');
                appScript.type = 'text/javascript';
                appScript.src = 'app.js';
                appScript.onload = function() {
                    console.log('app.js 加载成功！');
                };
                appScript.onerror = function() {
                    console.error('app.js 加载失败！');
                };
                document.body.appendChild(appScript);
            }
        })();
    </script>
</head>
<body>
    <div id="app">
        <!-- ==================== 页面标题 ==================== -->
        <header class="app-header" :style="{ opacity: (pullDistance > 0 || isRefreshing) ? 0 : 1 }">
            <h1>{{ title }}</h1>
            <p class="subtitle">{{ subtitle }}</p>
        </header>
        
        <!-- ==================== 分类切换区域 ==================== -->
        <section class="category-section">
            <h2>选择商品分类</h2>
            <div class="category-tabs">
                <button
                    v-for="cat in categories"
                    :key="cat.value"
                    class="category-tab"
                    :class="{ 'active': currentCategory === cat.value }"
                    :style="{ '--tab-color': cat.color }"
                    @click="switchCategory(cat.value)"
                >
                    <span class="tab-label">{{ cat.label }}</span>
                </button>
            </div>
        </section>
        
        <!-- ==================== 下拉刷新区域 ==================== -->
        <section 
            class="pull-refresh-section"
            :style="{ '--theme-color': refreshConfig.color }"
            :class="`theme-${refreshConfig.theme}`"
        >
            <!-- 刷新头部（动态显示） -->
            <div 
                class="refresh-header"
                :class="`status-${pullStatus}`"
                :style="refreshHeaderStyle"
                v-show="pullDistance > 0"
            >
                <!-- 动态渲染动画图标 -->
                <div 
                    class="animation-container"
                    v-html="renderAnimationIcon()"
                ></div>
                
                <!-- 动态文案 -->
                <p class="refresh-text">{{ refreshText }}</p>
            </div>
            
            <!-- 商品列表容器 -->
            <div 
                class="goods-container"
                :style="{ transform: `translateY(${Math.max(pullDistance, 0)}px)` }"
            >
                <div class="goods-list">
                    <div
                        v-for="goods in goodsList"
                        :key="goods.id"
                        class="goods-item"
                    >
                        <div class="goods-image">{{ goods.image }}</div>
                        <div class="goods-info">
                            <h3 class="goods-name">{{ goods.name }}</h3>
                            <p class="goods-price">¥{{ goods.price }}</p>
                        </div>
                    </div>
                </div>
                
                <!-- 提示信息 -->
                <div class="tips">
                    <p>📱 向下拉动页面即可刷新</p>
                    <p>✨ 根据分类显示不同的动画和样式</p>
                </div>
            </div>
        </section>
        
        <!-- ==================== 功能说明区域 ==================== -->
        <section class="info-section">
            <h2>功能说明</h2>
            <div class="info-content">
                <div class="info-item">
                    <h3>🎯 核心功能</h3>
                    <ul>
                        <li>根据商品分类（生鲜、数码、服饰）显示不同的下拉刷新样式</li>
                        <li>原生实现下拉刷新功能（不依赖第三方库）</li>
                        <li>动态渲染不同的动画组件和文案</li>
                        <li>支持配置化和组件化</li>
                    </ul>
                </div>
                
                <div class="info-item">
                    <h3>🔧 技术实现</h3>
                    <ul>
                        <li><strong>配置化：</strong>通过配置表管理不同分类的样式和文案</li>
                        <li><strong>组件化：</strong>动画组件独立封装，便于维护和扩展</li>
                        <li><strong>状态驱动：</strong>根据下拉状态（pulling/loosing/loading）动态切换样式</li>
                        <li><strong>触摸事件：</strong>使用 touchstart/touchmove/touchend 实现下拉手势</li>
                    </ul>
                </div>
                
                <div class="info-item">
                    <h3>📱 使用方法</h3>
                    <ul>
                        <li>在移动端或浏览器开发者工具的移动设备模式下使用</li>
                        <li>在页面顶部向下拉动即可触发下拉刷新</li>
                        <li>点击分类标签切换不同的主题和动画</li>
                        <li>刷新完成后会自动更新商品列表</li>
                    </ul>
                </div>
            </div>
        </section>
    </div>
</body>
</html>

